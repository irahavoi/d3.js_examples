<!DOCTYPE html>
<html>
<head>
    <title>D3.js</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <!--<link rel="stylesheet" type="text/css" href="css/d3ia.css">-->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/network.css">
</head>
<body onload="forceDirectedNetwork()">
<div class="well">
    <div><svg style="width: 500px; height: 500px; border: 1px lightgray solid;"></svg></div>
</div>
<script type="text/javascript">
           function forceDirectedNetwork(){
              queue()
                .defer(d3.csv, "data/nodelist.csv")
                .defer(d3.csv, "data/edgelist.csv")
                .await(function(error, file1, file2){
                  createForceDirectedNetwork(file1, file2);
                });
           }

           function createForceDirectedNetwork(nodes, edges){
            var nodeHash = {};
            for(x in nodes){
              nodeHash[nodes[x].id] = nodes[x];
            }

            for(x in edges){
              edges[x].weight = parseInt(edges[x].weight);
              edges[x].source = nodeHash[edges[x].source];
              edges[x].target = nodeHash[edges[x].target];
            }

            var weightScale = d3.scale.linear()
              .domain(d3.extent(edges, function(d){return d.weight}))
              .range([.1, 1]);

            var force = d3.layout.force().charge(-1000)
              .size([500, 500])
              .nodes(nodes)
              .links(edges)
              .on("tick", forceTick);

            d3.select("svg").selectAll("line.link")
              //.data(edges, function(d){
              //  return d.source.id + "-" +d.target.id ;
              //})
              .data(edges)
              .enter()
              .append("line")
              .attr("class", "link")
              .style("stroke", "black")
              .style("opacity", .5)
              .style("stroke-width", function(d){return d.weight;});    

           }

           function forceTick(){
              console.log("todo");
           }



	</script>
</body>
</html>